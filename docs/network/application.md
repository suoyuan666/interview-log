# 应用层部分

这部分记录一些应用层部分的东西

## 1. 应用层有什么协议

HTTP, HTTPS, FTP, SMTP, POP3, DNS, SSH, Telnet, WebSocket

## 2. 介绍一下 HTTP 和 HTTPS

HTTP 是一种无状态的、基于请求-响应模型的协议，工作在 应用层，默认端口是 80

请求方法:

- GET：请求资源
- POST：提交数据（如表单）
- PUT：更新资源
- DELETE：删除资源
- HEAD：类似 GET，但只返回响应头，不返回正文

HTTPS 是 HTTP + TLS，默认端口是 443，主要通过 加密 和 身份验证 解决 HTTP 的安全问题

HTTPS 连接过程(TLS 四次握手):

- 客户端 Hello：客户端发送支持的 TLS 版本、加密算法列表等信息
- 服务器 Hello：服务器选择 TLS 版本和加密算法，并返回证书
- 证书验证：客户端验证服务器的证书是否可信
- 密钥交换：使用非对称加密（如 RSA、ECDHE），生成共享密钥（用于对称加密）
- 对称加密通信：双方使用共享密钥进行加密通信

使用 RSA 加密对称密钥的话，就是服务端发送公钥给客户端，客户端使用公钥加密密钥再发送回去，之后就可以使用该密钥做对称加密进行通信。如果服务器的私钥丢失就会造成很大的隐患

ECDHE 椭圆曲线加密支持前向加密，即哪怕私钥丢失都不会影响之前已发送的数据包

## 3. cookie 和 session 的区别

- cookie：存储在客户端的小型数据，用于记录用户状态或身份信息
- session：存储在服务器端的用户会话信息，通常用于管理用户登录状态

cookie 工作流程

- 服务器响应时向客户端 set-cookie，浏览器保存 cookie。

- 客户端每次请求都会携带 cookie，服务器读取其中的信息。

- 服务器根据 cookie 内容识别用户。

session 工作流程

- 用户首次访问时，服务器创建一个 session（存储在服务器内存或数据库中）。
- 服务器生成 session ID 并通过 cookie 发送给客户端。
- 之后的请求，客户端通过 cookie 携带 session ID，服务器根据 session ID 找到对应的会话数据。

## 4. 介绍一下 WebSocket

WebSocket 是一种 全双工、长连接 的通信协议，它允许服务器和客户端在 一个 TCP 连接上双向通信，避免了传统 HTTP 的 请求-响应 机制带来的开销

WebSocket 连接的建立 依赖 HTTP/HTTPS，但它是一个独立的协议

- 握手阶段（基于 HTTP 协议）
    - 客户端发送 WebSocket 握手请求（HTTP Upgrade 头）
    - 服务器返回 101 Switching Protocols，升级为 WebSocket 连接
    - 连接建立后，客户端和服务器可以双向通信，无需每次请求都建立新连接
- 通信阶段（全双工传输）
    - 客户端和服务器可以 随时主动 发送消息，不需要请求-响应
    - 数据以帧形式发送
- 关闭阶段
    - 任意一方可发送 Close 帧 关闭连接，释放资源
