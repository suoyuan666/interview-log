# 网络部分

## 1. 了解 IO 多路复用吗，`epoll` 和 `select` 的区别是什么

IO多路复用是指在单个线程中同时监视多个IO事件（例如读取、写入等），从而提高系统的并发处理能力，避免因线程/进程阻塞而导致的性能瓶颈。IO多路复用常见的实现方式有 `select`、`poll` 和 `epoll` 等。

> `select` 是一种 I/O 多路复用机制，它可以让一个进程同时监控多个文件描述符，判断这些文件描述符是否可以进行读取、写入或是否有异常发生。`select` 的工作原理是将一组文件描述符传给内核，内核会检查这些文件描述符的状态，并返回可以操作的文件描述符集合。
>
> `epoll` 是 Linux 提供的一种 I/O 多路复用机制，它是为了克服 `select` 的性能瓶颈而设计的。`epoll` 采用了事件驱动的方式，只有当文件描述符有事件发生时，内核才会通知用户进程，大大提高了效率，特别是在大量文件描述符的情况下。

差别：

**性能差距**

- `select`: `select` 的效率较低，尤其在监控的文件描述符数量较多时。它的缺点是每次调用时都需要将所有的文件描述符从用户空间拷贝到内核空间，检查是否有事件发生，然后再将结果拷贝回用户空间。文件描述符数量超过一定量时，性能下降显著（通常超过 1024 个文件描述符）。
- `epoll`: `epoll` 是 Linux 下为了解决 `select` 的性能瓶颈而设计的，它采用了基于事件的通知机制，不需要每次都遍历所有的文件描述符。它的性能随着文件描述符数量的增加而提高，适合高并发环境。

**支持的文件描述符数量**

- `select`: `select` 有一个最大文件描述符限制，通常是 1024（可以通过修改 `FD_SETSIZE` 来调整，但这不是非常灵活）。
- `epoll`: `epoll` 没有这个限制，支持的文件描述符数量是理论上无限制的，取决于操作系统的资源限制。

**调用方式**

- `select`: `select` 每次调用时都会把所有的文件描述符都传递给内核，内核会返回哪些文件描述符可以进行读写。它是轮询式的。
- `epoll`: `epoll` 则采用了事件驱动模型，它通过 `epoll_ctl` 添加或者删除文件描述符，而通过 `epoll_wait` 来等待有事件的文件描述符。`epoll` 会在内核空间维护一个文件描述符的列表，只有事件发生时，才会通知用户空间，避免了 `select` 中每次都要传递所有文件描述符的问题。

