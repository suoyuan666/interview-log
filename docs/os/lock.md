# 锁

这里说的是并发时候用到的锁

## 1. 死锁产生条件

- 互斥条件
    - 资源必须处于非共享模式，即一次只有一个进程可以使用一个资源。
    - 如果其他进程请求该资源，则请求进程必须等待直到该资源被释放。
- 请求与保持条件
    - 进程至少保持一个资源，并且正在请求由其他进程保持的额外资源
    - 也就是说，进程在等待其他资源的同时，不释放已占有的资源。
- 不剥夺条件
    - 资源只能由进程在完成任务后自愿释放，而不能被强制剥夺。
    - 也就是说，一个进程不能强行夺取其他进程已占有的资源。
- 循环等待条件
    - 存在一组等待进程 {P1, P2, ..., Pn}，其中 P1 等待 P2 占用的资源，P2 等待 P3 占用的资源，依此类推，直到 Pn 等待 P1 占用的资源
    - 形成一个进程等待资源的环形链

## 2. 如何避免死锁

- 破坏请求与保持条件
    - 要求进程在开始执行前一次性申请所有需要的资源，或者允许进程在需要新资源时释放已占有的资源。
- 破坏不剥夺条件
    - 如果进程请求的资源被其他进程占用，则可以剥夺该占用进程的资源。
    - 只有在可以安全地剥夺资源的情况下才能使用此方法。
- 破坏循环等待条件
    - 对所有资源进行排序，并要求进程按顺序申请资源。
